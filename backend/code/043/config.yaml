# MVE 043: Newton-Schulz Orthogonal DeltaNet Transition
# Task: S3 permutation composition
# Compare: UT transform (baseline) vs Newton-Schulz orthogonalization (proposed)

dataset:
  task: "s3"
  max_k: 20           # Sequence length (compose up to 20 permutations)
  samples_per_k: 250  # 250 samples per k -> 5K total
  max_seq_len: 32     # max_k + BOS + EOS + padding
  test_size: 0.2
  use_generators_only: true  # Only (12) and (123) as inputs

model:
  type: "ChunkedDeltaNet"
  d_model: 32         # Small for MVE (~80K params)
  nhead: 2
  num_layers: 2
  chunk_size: 32       # C = 32 (proposal MVE spec)
  dropout: 0.1
  allow_neg_eigval: true  # beta in (0, 2) for reflections
  ns_iters: 2          # Newton-Schulz iterations (proposal recommends 2-3)

training:
  batch_size: 64
  lr: 1e-3
  beta1: 0.9
  beta2: 0.999
  weight_decay: 0.01
  gradient_clip: 1.0
  max_epochs_per_stage: 50
  max_val_acc: 0.99

# Modal deployment config
deployment:
  gpu_type: "T4"
  n_gpus: 1
  timeout_seconds: 3600  # 1 hour max
